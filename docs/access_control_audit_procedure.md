# アクセス制御監査手順書

このドキュメントは、本システムにおけるアクセス制御の定期的な監査手順を定義します。

## 目的

アクセス制御の監査は、システム内の各コンポーネント、データベース、APIエンドポイントへのアクセス権限が、最小権限の原則に基づいて適切に設定されているかを確認し、不必要な特権を排除し、不正アクセスの試みを検知することを目的としています。

## 監査頻度

*   **定期監査**: 四半期ごと
*   **随時監査**: 重大なセキュリティインシデント発生時、またはシステムの大幅な変更があった場合

## 監査項目

### 1. ユーザーアカウントの確認

*   **アクティブユーザー**: 現在アクティブなユーザーアカウントの一覧を取得し、それぞれの権限を確認します。
*   **非アクティブユーザー**: 長期間ログインしていないユーザー、退職者などのアカウントが無効化されているか確認します。
*   **特権アカウント**: 管理者権限を持つアカウントのリストを作成し、その必要性と使用状況を確認します。

### 2. ロールと権限の確認

*   **ロール定義**: 定義されているロールとその権限が適切か確認します。
*   **ユーザーとロールのマッピング**: 各ユーザーが適切なロールに割り当てられているか確認します。
*   **最小権限の原則**: 各ロールが最小限の権限のみを持っているか確認します。

### 3. データベースアクセスの確認

*   **データベースユーザー**: データベースにアクセスするユーザーの一覧を取得し、それぞれの権限を確認します。
*   **スキーマとテーブルのアクセス権**: 各スキーマとテーブルへのアクセス権限が適切か確認します。
*   **特権操作**: `DROP`, `ALTER` などの特権的な操作を行う権限を持つユーザーを特定し、その必要性を確認します。

### 4. APIエンドポイントの確認

*   **エンドポイントと認可**: 各APIエンドポイントが適切な認可チェックを持っているか確認します。
*   **認可ロジック**: 認可ロジックが正しく実装されているか確認します。
*   **ログとモニタリング**: APIアクセスのログが記録され、異常なアクセスが検知できるか確認します。

### 5. アプリケーションコンポーネントの確認

*   **内部サービス間通信**: サービス間の通信が認証・認可されているか確認します。
*   **ファイルシステムアクセス**: アプリケーションがアクセスするファイルシステムのパスと権限を確認します。

## 監査手順

### 1. 準備

*   監査に必要なツールとアクセス権を準備します。
*   監査対象のシステムとデータのスナップショットを取得します（可能であれば）。

### 2. 実施

*   上記の監査項目に従って、各項目を確認します。
*   確認結果を記録します。
*   問題点や改善点を特定します。

### 3. 報告

*   監査結果をまとめたレポートを作成します。
*   レポートには、以下を含めます。
    *   監査の概要
    *   確認した項目と結果
    *   問題点とリスク
    *   改善提案
*   レポートを関係者に共有します。

### 4. 改善

*   レポートに基づいて、必要な改善措置を実施します。
*   改善状況を追跡します。

## ツール

*   **IAMツール**: ユーザー管理とロール管理を行うIAMツールを使用します。
*   **データベース管理ツール**: データベースのユーザーと権限を確認するためのツールを使用します。
*   **ログ分析ツール**: アクセスログを分析するためのツールを使用します。

## 責任者

*   **セキュリティチーム**: 監査の計画、実施、報告を主導します。
*   **システム管理者**: システムの設定とアクセス権限の提供を担当します。
*   **アプリケーション開発チーム**: アプリケーションレベルのアクセス制御の実装と確認を担当します。
