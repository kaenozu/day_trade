
# デイトレード推奨銘柄分析ツール仕様書

## 1. 概要

本ツールは、日本の株式市場を対象としたデイトレード用のコマンドラインインターフェース（CLI）アプリケーションである。複数のテクニカル指標を組み合わせたアンサンブル戦略に基づき、リアルタイムで株価データを分析し、売買推奨銘柄をコンソールに出力することを目的とする。

## 2. 機能要件

- **設定ファイル:** 分析対象とする銘柄のティッカーシンボルリストを外部ファイル（例: `tickers.txt`）から読み込む。
- **データ取得:** `yfinance`ライブラリ等を利用し、対象銘柄の分足データ（1分足、5分足、60分足など）をリアルタイムに取得する。
- **分析エンジン:** 後述する複数の分析戦略を並行して実行する。
- **アンサンブル判定:** 各戦略が出力したシグナルを統合し、最終的な推奨（「買い」「売り」「待機」）を決定する。
- **結果出力:** 分析結果をコンソールに表形式（テーブル）で分かりやすく表示する。表示項目には、銘柄名、現在価格、シグナル、各戦略の判定結果などを含む。

## 3. 分析戦略（アンサンブル戦略）

予測品質を高めるため、以下の複数の戦略を組み合わせる。

### 3.1. 基本戦略

1.  **短期トレンド追随戦略 (移動平均線クロス)**
    - **指標:** 短期移動平均線（SMA 5分）、中期移動平均線（SMA 25分）
    - **買いシグナル:** ゴールデンクロス（短期SMAが中期SMAを上抜く）
    - **売りシグナル:** デッドクロス（短期SMAが中期SMAを下抜く）

2.  **オシレーター戦略 (RSI)**
    - **指標:** 相対力指数（RSI 14期間）
    - **買いシグナル:** 30%以下の「売られすぎ」水準からの反発
    - **売りシグナル:** 70%以上の「買われすぎ」水準からの反落

3.  **出来高分析戦略**
    - **指標:** 出来高、出来高移動平均線
    - **シグナル:** 出来高が過去の平均（例: 20期間）と比べて急増（例: 2倍以上）した場合、トレンド発生の初動と判断する。

### 3.2. 予測品質向上戦略

1.  **VWAP戦略 (出来高加重平均価格)**
    - **指標:** VWAP
    - **買いシグナル:** 現在価格がVWAPを上回り、支持線として機能している。
    - **売りシグナル:** 現在価格がVWAPを下回り、抵抗線として機能している。

2.  **ボラティリティ戦略**
    - **指標1: ボリンジャーバンド**
        - **買いシグナル:** -2σバンドにタッチ、または下抜けた後の反発。
        - **売りシグナル:** +2σバンドにタッチ、または上抜けた後の反落。
        - **補助:** バンドの幅（スクイーズ/エクスパンション）をトレンド発生の予兆として監視する。
    - **指標2: ATR (Average True Range)**
        - **シグナル:** ATRが歴史的に低い水準から急上昇した場合、ボラティリティの拡大とトレンド発生の可能性を示唆する。

### 3.3. 戦略フィルタリング

1.  **複数時間軸での分析 (Multi-Timeframe Analysis)**
    - 長期（例: 60分足）のトレンド方向を分析し、その方向に合致する短期（例: 5分足）のシグナルのみを有効とする。
    - **例:** 60分足が上昇トレンドの場合、5分足の「買い」シグナルのみを考慮し、「売り」シグナルはノイズとして無視する。

2.  **市場センチメント分析**
    - 日経平均株価（^N225）やTOPIX先物などの主要な市場インデックスの動向を監視する。
    - **フィルター:** 市場全体が明確な下落トレンドの場合、「買い」シグナルの推奨度を一段階引き下げるか、無効化する。逆も同様。

## 4. 推奨ロジック

- **シグナル統合:** 上記の分析戦略（3.1, 3.2）のうち、**3つ以上**の戦略で「買い」（または「売り」）のシグナルが同時に発生した銘柄を「強く推奨」とする。
- **フィルタリング適用:** 統合されたシグナルに対して、戦略フィルタリング（3.3）を適用し、最終的な推奨を決定する。

## 5. 非機能要件

- **実行環境:** Python 3.10以上
- **インターフェース:** CLI (コマンドラインインターフェース)
- **主要ライブラリ:**
    - `pandas`
    - `numpy`
    - `yfinance`
    - `pandas-ta` (テクニカル指標計算用)
    - `tabulate` (結果表示用)

## 6. 将来的な拡張

- **パラメータ最適化:** バックテスト機能を追加し、各戦略のパラメータ（移動平均の期間、RSIの閾値など）を銘柄ごとに最適化する。
- **機械学習モデルの導入:** 過去の時系列データを学習させ、将来の値動きを予測する機械学習モデル（LightGBM, LSTM等）を開発し、アンサンブル戦略の一つとして組み込む。
